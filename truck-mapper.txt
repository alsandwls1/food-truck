<!-- 
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.example.demo.repository.TruckRepository">
	
	<insert id="insert" parameterType="Truck">
		insert into truck (t_name, t_food, t_avg, t_comment, t_open, t_close, t_lat, t_lng, t_foodmaterial, t_member) 
		values (#{tName},#{tFood}, #{tAvg}, #{tComment},#{tOpen},#{tClose},#{tLat},#{tLng},#{tFoodmaterial},#{tMember})
	</insert>
	<update id="update" parameterType="Truck">
		update truck 
		set t_name=#{tName}, t_food=#{tFood}, t_comment=#{tComment}, t_open=#{tOpen}, 
		t_close=#{tClose}, t_lat=#{tLat}, t_lng=#{tLng}, t_foodmaterial={tFoodmaterial} 
		where t_id=#{tId}
	</update>
	<delete id="delete" parameterType="int">
		delete from truck where t_id=#{tId}
	</delete>
	
	<select id="findAll" resultType="Truck">
		select * from truck
	</select>
	<select id="findOneById" parameterType="int" resultType="Truck">
		select * from truck where t_id=#{tId}
	</select>
	<select id="findOneByMember" parameterType="String" resultType="Truck">
		select * from truck where t_member=#{tMember}
	</select> 

	<update id="updateAvg" parameterType="int">
		 update truck set t_avg = (select round(avg(r_score), 1) from review where r_truck=#{tId}) where t_id=#{tId}
		update truck set t_avg = ??? where t_id=${tId}
	</update>
	
	<update id="updateLocal" parameterType="Truck">
		 update truck set  t_lat=#{tLat}, t_lng=#{tLng} where t_id=#{tId}
	</update> 
	
</mapper>
 -->